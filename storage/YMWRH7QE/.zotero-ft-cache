Subspace Robust Wasserstein Distances
François-Pierre PATY (ENSAE Paris) Marco CUTURI (Google Brain & ENSAE Paris)

Goal: Make sense of Wasserstein distances in high dimension by designing a robust variant of the Wasserstein.

Approach: Project the measures onto subspace and consider the maximum over

a all

ls/ou/w/b/-sd/p/ia/mc/eesn.sional

Results: Geodesic metric equivalent to the Wasserstein distance. Efficient algorithms and use case on text data.

github.com/francoispierrepaty/ SubspaceRobustWasserstein

I. Wasserstein Distance in High Dimension

II. Projection and Subspace Robust Wasserstein Distances

Wasserstein Distance

Projection Robust Wasserstein Distance (PRW)

The 2-Wasserstein distance between

measures µ and <latexit sha1_base64="NbP5ZUkhofyZXoAIjFN+wWClegI=">AAAFQXicjVRNb9NAEJ2mhpbw1RZuXCyiSBwg2FUlOFZCQhw4FGjaSm2FbGdTVrW9xl4jRVUl/gBX+EH8Cv4BvSGuXHgz3pQ2aVNsORnPzntvZna8cZHqygbBj7nWvHft+sLijfbNW7fv3F1aXtmqTF0mqp+Y1JQ7cVSpVOeqb7VN1U5RqiiLU7UdH77g9e1Pqqy0yTftqFD7WXSQ66FOIgvXu72sfr/UCXqBXP60ETqjQ+7aMMut+7RHAzKUUE0ZKcrJwk4pogr3LoUUUAHfPh3BV8LSsq7omNrA1ohSiIjgPcTvAd52nTfHO3NWgk6gkuIpgfSpC4xBXAmb1XxZr4WZvZdxHwkn5zbCf+y4MngtfYD3Ktw48n9xXIulIT2XGjRqKsTD1SWOpZaucOb+maosGAr42B5gvYSdCHLcZ18wldTOvY1k/adEspffExdb08nMLDexU5zhEPr5ufyau4unQfqo5Qk6pyUDxvmnqFn946rSM4yTNytUYM2AbHrRp7f0Wjoxkk4wq5Ve5eC8XClGNgbv3MEYEZOaXelziZihsLKqkWlLUdlHsLKlRdd3LE2nr5qOf324SDOWSWUUZ8g7NoB3PEP+6UzynM/SyuUbUlBr9vwiLf4aMoe0U9zNjvFkhfSUVukxLCVfbm+Gbia63LfxjhxP6U7GGGA5yzbOlnDyJJk2tlZ7YdAL36x11l9+bk6ZRXpAD+kRMn1G6/SKNjAXCVi/0Ff65n33Trxf3u8mtDXnTqZ7dO7y/vwFFZz/Ag==</latexit>

⌫ <latexit sha1_base64="zCgKiwei8HXSdcQJR588GO5looE=">AAAFQXicjVRNb9NAEJ2mhpbw1RZuXCyiSBwg2FUlOFZCQhw4FGjaSm2FbGdTVrV3jb1GiqpK/AGu8IP4FfwDekNcufBm7JQ2aVNsORnPzntvZna8cZ7q0gXBj7nWvHft+sLijfbNW7fv3F1aXtkqbVUkqp/Y1BY7cVSqVBvVd9qlaicvVJTFqdqOD1/w+vYnVZTamk03ytV+Fh0YPdRJ5OB6t2eq90udoBfI5U8bYWN0qLk27HLrPu3RgCwlVFFGigw52ClFVOLepZACyuHbpyP4Clha1hUdUxvYClEKERG8h/g9wNtu4zV4Z85S0AlUUjwFkD51gbGIK2Czmi/rlTCz9zLuI+Hk3Eb4jxuuDF5HH+C9CjeO/F8c1+JoSM+lBo2acvFwdUnDUklXOHP/TFUODDl8bA+wXsBOBDnusy+YUmrn3kay/lMi2cvvSRNb0cnMLDexU5zhEPrmXH713cVTI33U8gSd05IB4/xT1Kz+cVXpGcbJmxVKsGZA1r3o01t6LZ0YSSeY1UmvDDgvV4qRjcU7dzBGxKRmV/pcIGYorKxqZdpSVPYRrGxp0fUblrrTV03Hvz5cpBnLpDKKM+QdG8A7niH/dCZ5zmdpGfmGFNTqPb9Ii7+GrEG6Ke56x3iyQnpKq/QYlpIvtzdDNxNd7tt4R46ndCdjLLCcZRtnSzh5kkwbW6u9MOiFb9Y66y8/16fMIj2gh/QImT6jdXpFG5iLBKxf6Ct98757J94v73cd2pprTqZ7dO7y/vwFGnj/Aw==</latexit>

is

defined by
Z

two

probability

W2(µ, ⌫)
<latexit sha1_base64="vU4dakIULJauqPVf1BvEwZJ394w=">AAAFjnicjVRdTxNREB3QKtavor75ciMhgQRK2xj1hUj0hQdjqqFAwgLZ3d7CDfvl7l1DU/qv/DP6qg/6Lzwzu0VoobibbefOnXPOzNzZ9ZLAZLbR+D4ze+t25c7duXvV+w8ePnpcm3+yncV56uuOHwdxuuu5mQ5MpDvW2EDvJql2Qy/QO97Je97f+arTzMTRlu0nej90jyLTM75r4TqsfXRC1x77bjDYGR60lpwwX3GifFmtK8dEvcOBkxi2lNM2sql4d8guq5yz09W+c3bQUl2ELZ2u9JcPawuNekMuNWk0S2OByqsdz88+I4e6FJNPOYWkKSILOyCXMtx71KQGJfDt0wC+FJaRfU1DqgKbI0ojwoX3BL9HWO2V3ghr5swE7UMlwJMCqWgRmBhxKWxWU7KfCzN7r+MeCCfn1se/V3KF8Fo6hvcm3Cjyf3Fci6UevZEaDGpKxMPV+SVLLl3hzNWFqiwYEvjY7mI/he0LctRnJZhMaufeurL/WyLZy2u/jM3pz9Qst3BSnGEP+tGl/Ip7EU+BVKhlFZ0zkgHj1DlqWv+4quAC4/jNChlYQyCLXnToM32QTvSlE8xqpVcROK9X8pBNjDV30EPEuOai9DlFTE9YWTWWaQtQ2RewsmVEV5UsRadvmo5/fbhK05NJZRRnyCfWhXc0Q+p8JnnOp2lF8g5pqBVnfpUWvw1hibQT3MWJ8WQ1aY1atAJLy5tbn6Ibii73bXQiwwnd8ZgYWM6yim9Lc/xLMmlst+rNRr356eXCxrvyKzNHz+kFLSHT17RBm9TGXPj0jX7QT/pVqVVeVdYrb4vQ2ZkS85QuXZXNvxwpFjI=</latexit>

=

inf
⇡2⇧(µ,⌫)

kx yk2d⇡(x, y)

where ⇧(µ, ⌫)is <latexit sha1_base64="EAeuYkKReq0oUxulqtvVbtaA6aU=">AAAFSnicjVRNb9NAEJ0GF0r4aoEbF4soUpFKsKtK5VgJCXHgEFDTVqorZDubsqrtNfYaKaoq8Su4wg/iD/AP4MoNceHN2Clt0qbYcjKenffezOx4ozzRpfW87wuta87i9RtLN9u3bt+5e2955f5OaaoiVoPYJKbYi8JSJTpTA6ttovbyQoVplKjd6OgFr+9+VEWpTbZtx7k6SMPDTI90HFq4gqCvV4O0Wguy6sm75Y7X8+RyZw2/MTrUXH2z0npIAQ3JUEwVpaQoIws7oZBK3Pvkk0c5fAd0DF8BS8u6ohNqA1shSiEihPcIv4d422+8Gd6ZsxR0DJUETwGkS11gDOIK2KzmynolzOy9jPtYODm3Mf6jhiuF19J7eK/CTSL/F8e1WBrRc6lBo6ZcPFxd3LBU0hXO3D1TlQVDDh/bQ6wXsGNBTvrsCqaU2rm3oaz/kEj28nvcxFb0c26W29gpznAE/excfvXdxVMjXdTyFJ3TkgHj3FPUvP5xVckZxumbFUqwpkDWvRjQW3otnRhLJ5jVSq8ycF6uFCEbg3fuYISIac2u9LlAzEhYWdXItCWo7ANY2dKi6zYsdaevmo5/fbhIM5JJZRRnyDs2hHcyQ+7pTPKcz9PK5BtSUKv3/CIt/hrSBmlnuOsd48ny6Rmt0xosJV9ub45uKrrct8mOnMzoTscYYDnLNs4Wf/okmTV21nu+1/PfbHS2Xn6qT5klekSPaRWZbtIWvaI+5iIG82f6Ql+db84v57fzpw5tLTQn0wM6dy06fwFCGQE9</latexit>

the

set

of

couplings

between µ

and

⌫. <latexit sha1_base64="zCgKiwei8HXSdcQJR588GO5looE=">AAAFQXicjVRNb9NAEJ2mhpbw1RZuXCyiSBwg2FUlOFZCQhw4FGjaSm2FbGdTVrV3jb1GiqpK/AGu8IP4FfwDekNcufBm7JQ2aVNsORnPzntvZna8cZ7q0gXBj7nWvHft+sLijfbNW7fv3F1aXtkqbVUkqp/Y1BY7cVSqVBvVd9qlaicvVJTFqdqOD1/w+vYnVZTamk03ytV+Fh0YPdRJ5OB6t2eq90udoBfI5U8bYWN0qLk27HLrPu3RgCwlVFFGigw52ClFVOLepZACyuHbpyP4Clha1hUdUxvYClEKERG8h/g9wNtu4zV4Z85S0AlUUjwFkD51gbGIK2Czmi/rlTCz9zLuI+Hk3Eb4jxuuDF5HH+C9CjeO/F8c1+JoSM+lBo2acvFwdUnDUklXOHP/TFUODDl8bA+wXsBOBDnusy+YUmrn3kay/lMi2cvvSRNb0cnMLDexU5zhEPrmXH713cVTI33U8gSd05IB4/xT1Kz+cVXpGcbJmxVKsGZA1r3o01t6LZ0YSSeY1UmvDDgvV4qRjcU7dzBGxKRmV/pcIGYorKxqZdpSVPYRrGxp0fUblrrTV03Hvz5cpBnLpDKKM+QdG8A7niH/dCZ5zmdpGfmGFNTqPb9Ii7+GrEG6Ke56x3iyQnpKq/QYlpIvtzdDNxNd7tt4R46ndCdjLLCcZRtnSzh5kkwbW6u9MOiFb9Y66y8/16fMIj2gh/QImT6jdXpFG5iLBKxf6Ct98757J94v73cd2pprTqZ7dO7y/vwFGnj/Aw==</latexit>

<latexit sha1_base64="NbP5ZUkhofyZXoAIjFN+wWClegI=">AAAFQXicjVRNb9NAEJ2mhpbw1RZuXCyiSBwg2FUlOFZCQhw4FGjaSm2FbGdTVrW9xl4jRVUl/gBX+EH8Cv4BvSGuXHgz3pQ2aVNsORnPzntvZna8cZHqygbBj7nWvHft+sLijfbNW7fv3F1aXtmqTF0mqp+Y1JQ7cVSpVOeqb7VN1U5RqiiLU7UdH77g9e1Pqqy0yTftqFD7WXSQ66FOIgvXu72sfr/UCXqBXP60ETqjQ+7aMMut+7RHAzKUUE0ZKcrJwk4pogr3LoUUUAHfPh3BV8LSsq7omNrA1ohSiIjgPcTvAd52nTfHO3NWgk6gkuIpgfSpC4xBXAmb1XxZr4WZvZdxHwkn5zbCf+y4MngtfYD3Ktw48n9xXIulIT2XGjRqKsTD1SWOpZaucOb+maosGAr42B5gvYSdCHLcZ18wldTOvY1k/adEspffExdb08nMLDexU5zhEPr5ufyau4unQfqo5Qk6pyUDxvmnqFn946rSM4yTNytUYM2AbHrRp7f0Wjoxkk4wq5Ve5eC8XClGNgbv3MEYEZOaXelziZihsLKqkWlLUdlHsLKlRdd3LE2nr5qOf324SDOWSWUUZ8g7NoB3PEP+6UzynM/SyuUbUlBr9vwiLf4aMoe0U9zNjvFkhfSUVukxLCVfbm+Gbia63LfxjhxP6U7GGGA5yzbOlnDyJJk2tlZ7YdAL36x11l9+bk6ZRXpAD+kRMn1G6/SKNjAXCVi/0Ff65n33Trxf3u8mtDXnTqZ7dO7y/vwFFZz/Ag==</latexit>

The Wasserstein distance has become a classical tool in several machine learning applications:

• Domain adaptation • Color transfer • WGAN • NLP

Curse of Dimensionality

In data random

sciences, we only have access to data, i.e. to

samples x1, <latexit sha1_base64="r6EbQQaeTyq4NM1I+lu9VnWuSmw=">AAAFWXicjVRNb9NAEJ2EBkL4SikXxGVFFIlDSO0KCY6VkBAHDgU1baWmimxnU6zaXmOvUaOqgj/DFX4P4g/Av+DN2Clt0qbYcjKenffezOx4/TQKc+s4P2v1GyuNm7eat1t37t67/6C9+nAnN0UW6EFgIpPt+V6uozDRAxvaSO+lmfZiP9K7/tFrXt/9rLM8NMm2nab6IPYOk3ASBp6Fa9R+fDxye2oYjY3Ne+p4lKhhHsZqGBejdsfpO3KpRcOtjA5V15ZZrT+iIY3JUEAFxaQpIQs7Io9y3PvkkkMpfAd0Al8GK5R1TafUArZAlEaEB+8Rfg/xtl95E7wzZy7oACoRngxIRV1gDOIy2KymZL0QZvZexX0inJzbFP9+xRXDa+kjvNfhZpH/i+NaLE3oldQQoqZUPFxdULEU0hXOXJ2ryoIhhY/tMdYz2IEgZ31Wgsmldu6tJ+u/JZK9/B5UsQX9WZrlNnaKM5xAP7mQX3l38ZRIhVqeo3OhZMA4dYZa1j+uKjrHOH+zQg7WGMiyFwP6QO+kE1PpBLNa6VUCzquVfGRj8M4d9BExr9mVPmeImQgrqxqZtgiVfQIrW6Hoqoql7PR10/GvD5dp+jKpjOIMecfG8M5mSJ3NJM/5Mq1EviENtXLPL9PiryGukHaBu9wxniyX1mmDerC0fLn9Jbqx6HLfZjtyuqA7H2OA5SxbOFvc+ZNk0djZ6LtO333/orP55mt5yjTpCT2lZ8j0JW3SW9rCXAT0hb7Rd/qx8qtRazQbrTK0XqtOpjW6cDXW/gLWAwNu</latexit>

.

.

.

,

xn

⇠

µ;

y1, <latexit sha1_base64="dqFHLe/iKUDoHJb7YjYq5J+Lq4o=">AAAFWXicjVRNb9NAEJ2EBkL4SikXxGVFFIlDSO0KqRwrISEOHApq2kpNFdnOpqzqL+x1paiq4M9whd+D+APwL3gzdkqbtCm24oxn5703MztePw1Nbh3nZ61+a6Vx+07zbuve/QcPH7VXH+/mSZEFehAkYZLt+16uQxPrgTU21Ptppr3ID/Wef/yG1/dOdJabJN6x01QfRt5RbCYm8Cxco/bT6cjtqWE4TmzeU9NRpIa5wSMuRu2O03fkUouGWxkdqq7tZLX+hIY0poQCKigiTTFZ2CF5lOM+IJccSuE7pFP4MlhG1jWdUQvYAlEaER68x3ge4e2g8sZ4Z85c0AFUQvwyIBV1gUkQl8FmNSXrhTCz9zruU+Hk3Kb49yuuCF5Ln+C9CTeL/F8c12JpQq+lBoOaUvFwdUHFUkhXOHN1oSoLhhQ+tsdYz2AHgpz1WQkml9q5t56s/5ZI9vJ7UMUW9GdpljvYKc5wAv34Un7l3cWvRCrU8hKdM5IB49Q5aln/uKrwAuP8zQo5WCMgy14M6CO9l05MpRPMaqVXMTivV/KRTYJ37qCPiHnNrvQ5Q8xEWFk1kWkLUdlnsLJlRFdVLGWnb5qOf324StOXSWUUZ8g7NoZ3NkPqfCZ5zpdpxfINaaiVe36VFn8NUYW0C9zljvFkubROG9SDpeXL7S/RjUSX+zbbkbMF3fmYBFjOsoWzxZ0/SRaN3Y2+6/TdD686W2+/lqdMk57Rc3qBTDdpi97RNuYioC/0jb7Tj5VfjVqj2WiVofVadTKt0aWrsfYX39QDcA==</latexit>

.

.

.

,

ym

⇠⌫

What is really computed is the Wasserstein distance
between the empirical measures on the samples W(µˆ, ⌫ˆ)
<latexit sha1_base64="ceh4+ZI25pNEP5Ia2qfVbWx2SME=">AAAFXXicjVRdaxNREJ3GrtZYa6qCD0VYDIEKNe4WQR8LgvjgQy1NU2hK2d3cNJful7t3hRACgr/GV/01Pvmq/8Izs5vaJm3qLpvMzp1zzszc2eunoc6N4/xcqt1atm7fWblbv7d6f+1BY/3hQZ4UWaA6QRIm2aHv5SrUseoYbUJ1mGbKi/xQdf2zt7ze/ayyXCfxvhml6jjyTmM90IFn4DppPO1FnhkGXjjuTjZ7Q8/0omLLFiMunp80mk7bkcueN9zKaFJ17SbrtcfUoz4lFFBBESmKycAOyaMc9xG55FAK3zGN4ctgaVlXNKE6sAWiFCI8eM/we4q3o8ob4505c0EHUAnxZEDa1AImQVwGm9VsWS+Emb3XcY+Fk3Mb4d+vuCJ4DQ3hvQk3jfxfHNdiaEBvpAaNmlLxcHVBxVJIVzhz+0JVBgwpfGz3sZ7BDgQ57bMtmFxq5956sv5bItnL70EVW9CfhVnuY6c4wwH040v5lXcLT4m0UcsLdE5LBoyzz1GL+sdVhRcYZ29WyMEaAVn2okN79EE6MZJOMKuRXsXgvF7JRzYJ3rmDPiJmNVvS5wwxA2Fl1USmLURln8DKlhZdu2IpO33TdPzrw1WavkwqozhD3rE+vNMZss9nkud8kVYs35CCWrnnV2nx1xBVSDPHXe4YT5ZLL2mbtmAp+XLbC3Qj0eW+TXdkMqc7G5MAy1nWcba4syfJvHGw3XadtvvxVXPn3ZfylFmhDXpGm8j0Ne3Qe9rFXAT0lb7Rd/qx/MuyrFVrrQytLVUn0yO6dFlP/gLAzwXd</latexit>
In high-dimension, this can be very different from the real Wasserstein:

|W(µ, ⌫)
<latexit sha1_base64="p1YtQv+OBXuBw62rsLB7TG++S2M=">AAAFm3icjVRta9NQFD6bVmd969RvIgRLoYOtTYagHwcDEdmHKes6aOZI0ts2LG8mN0IpBf+aP8NfoH7Tf+BzTtK5tltnQpuTc8/zPOece3LdJPAzbZrf19Zv3a7cubtxr3r/wcNHj2ubT46zOE891fHiIE5PXCdTgR+pjvZ1oE6SVDmhG6iue77P690vKs38ODrS40Sdhs4w8ge+52i4zmo9O1ADbSNEG3bo6JHnBJPutGmH+bYd5VvGzrx75GhZ4icv26k/HM3wmR8aTasdbX2aWO3+9KxWN1umXMayYZVGncrrMN5cf0Y29Skmj3IKSVFEGnZADmW4e2SRSQl8pzSBL4Xly7qiKVWBzRGlEOHAe47/Id56pTfCO3NmgvagEuCXAmlQA5gYcSlsVjNkPRdm9l7HPRFOzm2Mp1tyhfBqGsF7E24W+b84rkXTgN5IDT5qSsTD1XklSy5d4cyNS1VpMCTwsd3HegrbE+Ssz4ZgMqmde+vI+k+JZC+/e2VsTr9WZnmEneIMB9CP5vIr7gZ+BdJALTvonC8ZMM64QK3qH1cVXGJcvFkhA2sIZNGLDn2kA+nEWDrBrFp6FYHzeiUX2cR45w66iFjUbEifU8QMhJVVY5m2AJV9BitbvugaJUvR6Zum418frtJ0ZVIZxRnyjvXhnc2QcTGTPOertCL5hhTUij2/Sou/hrBE6iXuYsd4sixq0y5tw1Ly5bZW6Iaiy32b7ch0SXcxJgaWs6zibLEWT5Jl43i3ZZkt68Or+t7br8Ups0HP6SU1kelr2qN3dIi58Ogb/aDf9KfyorJfeV85KELX18qT6SnNXZXOXx8vHS8=</latexit>

W(µˆ, ⌫ˆ)| ⇠ (1/n)1/d

Two-step approach

In applications, people use a two-step approach:
1. Reduce dimension using PCA 2. Compute the Wasserstein distance between the
projected point clouds
We propose a one-step approach, combining dimensionality reduction and optimal transport.

Pk(µ, ⌫)
<latexit sha1_base64="ZfcmUzHTrzbmgMHVVQyg2/5Cv8o=">AAAFpnicjVRNb9NAEJ0WAiV8pcCNy4qoUiqVkFRIcEGqhIo4IBRQ01Sqq2A7m8SKv7DXiCiKxA/kD/AP4MoVDrwZO2mbtCm2nMzOzntvZnZsJ/a91DQaP9bWr10v3bi5cat8+87de/crmw8O0yhLXN12Iz9Kjhw71b4X6rbxjK+P4kTbgePrjjN6zfudLzpJvSg8MONYnwT2IPT6nmsbuLqVvhXYZuja/qQ17Y5qVpDtWGG2rV4pK83i7sQy+quZ9LxgWttn72iq5ogObF/3TU1NWt39adeqAq52TldhpqzEGwzNdrdSbdQbcqllo1kYVSquVrS5/ogs6lFELmUUkKaQDGyfbEpxH1OTGhTDd0IT+BJYnuxrmlIZ2AxRGhE2vCP8DrA6Lrwh1syZCtqFio8nAVLRFjAR4hLYrKZkPxNm9l7GPRFOzm2Mf6fgCuA1NIT3Ktws8n9xXIuhPr2UGjzUFIuHq3MLlky6wpmrM1UZMMTwsd3DfgLbFeSsz0owqdTOvbVl/6dEspfXbhGb0a+VWR7gpDjDPvTDc/nl9xaeHKlQy1N0zpMMGKfmqFX946r8M4yLNyukYA2AzHvRpo/0Tjoxlk4wq5FeheC8XMlBNhHW3EEHEYuaW9LnBDF9YWXVSKbNR2WfwcqWJ7qqYMk7fdV0nPbhIk1HJpVRnCGfWA/e2Qyp+UzynK/SCuUd0lDLz/wiLX4bggJplrjzE+PJatIz2qUdWFre3PoK3UB0uW+zE5ku6S7GRMBylmV8W5qLX5Jl43C33mzUmx+eV/fefMu/Mhv0mJ5QDZm+oD16Sy3MhUvf6Tf9ob+lWul9qV3q5KHra8WX6SGdu0qf/gHdQiDW</latexit>

=

sup W
dim(E)=k

µ

E

PE #µ, PE #⌫

Not convex !

x1

ET] µ

⌫
y2

x2

y1

ET ]⌫
xn

Subspace Robust Wasserstein Distance (SRW)

• Corresponding "min-max" problem:
Z

Sk2(µ, ⌫)
<latexit sha1_base64="8KZsCrFG/qR/x7scemftojUo7YE=">AAAFrXicjVRLb9NAEJ6kGEp4pcCNy4ooUiqlqR0hwQWpEiriwCFA01aq28h2NukqfmGvUaPUEv+RE/8AfgI3ZsZOaZM2xZaT2Zn5vnns7Lqxr1Jtmj8r1bU7xt176/drDx4+evykvvF0P42yxJN9L/Kj5NB1UumrUPa10r48jBPpBK4vD9zJO7IffJNJqqJwT09jeRw441CNlOdoVA3qgR04+tRz/NmXfDA56bbsIGvbYbYp3gpbhaPBzI4VScLuKTKKtiBzLuw0i9Gq5ZmeDVWQt3YJM8nJWQv7XPQGu62zremmfX7SFXZ7iESDesPsmPyIZcEqhQaUTy/aqD4HG4YQgQcZBCAhBI2yDw6k+B6BBSbEqDuGGeoSlBTbJeRQQ2yGXhI9HNRO8HeMq6NSG+KaOFNGexjFxy9BpIAmYiL0S1CmaILtGTOT9ibuGXNSblP8d0uuALUaTlF7G27u+b84qkXDCN5wDQprillD1XklS8ZdoczFpao0MsSoI3mI9gRlj5HzPgvGpFw79dZh+y/2JC2tvdI3g98rs9zDnaIMRxg/vJJf8TbxK5ACa9nCzinOgHDiArWqf1SVf4lx8aUIKbIGiCx60YfP8JE7MeVOEKvmXoXIeXMkF7OJcE0ddNFjMWaT+5ygz4hZKWrE0+ZjZV+RlSTFcUXJUnT6tun414frYro8qYSiDGnHhqidz5C4mEma81WxQj5DEqMVe35dLDoNQYnUS9zFjtFkWbANXWijJPnkdlbEDTgu9W2+I/lS3EWfCLGUZQ3vFmvxJlkW9rsdy+xYn141dt5/L26ZdXgBL6GFmb6GHfgAPZwLD37An0q1smZsG33DNk4K12qlvJmewZXHGP8FOzYgTw==</latexit>

=

inf sup
⇡2⇧(µ,⌫) dim(E)=k

kPE (x

y)k2 d⇡

•

SRW is a convex relaxation of PRW:

⇣

⌘

Sk(µ, ⌫)
<latexit sha1_base64="Hi44bdemkP5QL/6e6gP4otx3y8Q=">AAAF53icjVTbbtNAEJ0UAqVQ2gJvvKyIKqVSSe2CBA9UqoSEQEKiQG9SXSJ7s0mt+JLaa9TKssQf8IZ45Ylv4g/gLzizdkKbtCm2nMzOzjlnZnZsbxD4qbasX7WZa9frN27O3pq7fWf+7sLi0r3dNM4SqXZkHMTJvuemKvAjtaN9Haj9QaLc0AvUntd/yft7n1WS+nG0rU8H6jB0e5Hf9aWr4Wov/nRCVx9JN8g/Fu1+0wmzVeFE2YrYwMZJO3fSzEu1K/u5JRwwS3UsnHeh6rmj5RvHcbQ60blOXKmKZrkNBtEvCjHi34MdqK5uiryM+JTba+tF0XYaUBWrF7ijTDiJ3zvSK6K92LBalrnEpGFXRoOqaytemnlADnUoJkkZhaQoIg07IJdS3Adkk0UD+A4phy+B5Zt9RQXNAZshSiHChbeP3x5WB5U3wpo5U4OWUAnwJEAKWgYmRlwCm9WE2c8MM3sv484NJ+d2in+v4grh1XQE71W4YeT/4rgWTV16bmrwUdPAeLg6WbFkpiucuThTlQbDAD62O9hPYEuDHPZZGExqaufeumb/t4lkL69lFZvRn6lZbuOkOMMu9KNz+ZX3Mp4SKVDLY3TONxkwToxQ0/rHVQVnGMdvVkjBGgJZ9mKHPtBb04lT0wlm1aZXETgvV/KQTYw1d9BDxLjmsulzgpiuYWXV2ExbgMqOwcqWb3RFxVJ2+qrp+NeHizQ9M6mM4gz5xDrwDmdIjGaS53yaVmTeIQW18swv0uK3IayQeoK7PDGeLJvWaJ1WYSnz5ram6IZGl/s2PJFiQnc8JgaWs5zDt8Ue/5JMGrvrLdtq2e+fNjZffSm/MrP0kB5RE5k+o016TVuYC1mbrz2pvaht1P361/q3+vcydKZWfZnu07mr/uMvasg3Hg==</latexit>

=

max W
0⌦I trace(⌦)=k

⌦1/2#µ, ⌦1/2#⌫

• SRW finds a coupling π minimizing the spectral cost:

Sk2(µ, ⌫)
<latexit sha1_base64="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LNM=LSA<WYi/cDxl7nnajLOtbWYeHZuxHwziHtxtT7R>5ukJh9JSYMc6ma/7NTs3drZprW2RW2d0+p28+4m15huWO2XQ/ptmBr1L692ak//VqVCUab2f6aMmGDdXL7t2RBgFLl2W7xkSiKIHmTibNL2/7mSTNGTNm/3pgQDTJfcu1xYvHiPRpWdO2//9p0bJkHf/+7phQTv3a68H3banzmrxOfvYWv6uGe9e0tmpVOWGjrHCtTpfk2U8eP1qYJk9+ANmYTp1u3QnT=Sp=1a<tm/vzl49aBAtu7eLnxIyiaGtWl>w8==</latexit>

=

Xk min
⇡2⇧(µ,⌫) l=1

l (V⇡ )

Where

V⇡ <latexit sha1_base64="uQoOUQt039M9V0Ux65XNEzTeXs0=">AAAFQ3icjVRNb9NAEJ0GAyV8tcCNi0UUiQMEu0Iqx0pIiAOHgpq0UltVtrMpq9peY68rRVUl/gFX+EH8CP4BiBviisSb8aa0SZtiy8l4dt57M7PjjYtUVzYIvi20rnhXr11fvNG+eev2nbtLy/cGlanLRPUTk5pyK44qlepc9a22qdoqShVlcao244OXvL55qMpKm3zDjgu1m0X7uR7pJLJw9Qd7O4XeW+oEvUAuf9YIndEhd62b5dYD2qEhGUqopowU5WRhpxRRhXubQgqogG+XjuArYWlZV3RMbWBrRClERPAe4Hcfb9vOm+OdOStBJ1BJ8ZRA+tQFxiCuhM1qvqzXwszei7iPhJNzG+M/dlwZvJbew3sZbhL5vziuxdKIXkgNGjUV4uHqEsdSS1c4c/9UVRYMBXxsD7Fewk4EOemzL5hKaufeRrL+XSLZy++Ji63px9wsN7BTnOEI+vmZ/Jq7i6dB+qjlKTqnJQPG+Seoef3jqtJTjNM3K1RgzYBsetGnd/RGOjGWTjCrlV7l4LxYKUY2Bu/cwRgR05pd6XOJmJGwsqqRaUtR2QewsqVF13csTacvm45/fThPM5ZJZRRnyDs2hHcyQ/7JTPKcz9PK5RtSUGv2/Dwt/hoyh7Qz3M2O8WSF9IxW6AksJV9ub45uJrrct8mOHM/oTscYYDnLNs6WcPokmTUGK70w6IVvn3fWXn1sTplFekiP6DEyXaU1ek3rmIsEKp/oM33xvno/vV/e7ya0teBOpvt05vL+/AWr5f/C</latexit>

is the Second Order Moment Matrix of the

Displacements:
Z

V⇡ = (x y)(x y)T d⇡(x, y)

<latexit sha1_base64="1zcvISlpT5kpI2XqXrg9PeqChTg=">AAAFY3icjVTdThNREB6QKhZ/ALkzJic2TUoCdZeY6I0JiTdeGIOmLSQUye72FE/YP3fPGhrCA/g03uqj+AAm+hZ+M7tFaKG4m27nzJnv+2bmzK6fhia3jvNzbv7WQu32ncW79aV79x88XF5Z7eVJkQW6GyRhku35Xq5DE+uuNTbUe2mmvcgP9a5//Jr3d7/oLDdJ3LGjVB9E3lFshibwLFyHy43eYT816pXqm9iq1snmaF0eHztqgI3WycZoHVFO25FLTRtuZTSounaSlfk16tOAEgqooIg0xWRhh+RRjnufXHIohe+ATuHLYBnZ13RGdWALRGlEePAe43mE1X7ljbFmzlzQAVRC/DIgFTWBSRCXwWY1JfuFMLP3Ou5T4eTcRvj3K64IXkuf4L0JN478XxzXYmlIL6UGg5pS8XB1QcVSSFc4c3WhKguGFD62B9jPYAeCHPdZCSaX2rm3nuz/lkj28jqoYgv6MzPLDk6KMxxCP76UX3k38SuRCrVsonNGMmCcOkfN6h9XFV5gnLxZIQdrBGTZiy59oLfSiZF0glmt9CoG5/VKPrJJsOYO+oiY1GxKnzPEDIWVVROZthCVfQYrW0Z0VcVSdvqm6fjXh6s0fZlURnGGfGIDeMczpM5nkud8llYs75CGWnnmV2nx2xBVSDvFXZ4YT5ZLz2iLNmBpeXPbM3Qj0eW+jU/kbEp3MiYBlrOs49viTn5Jpo3eVtt12u77543td9VXZpEe01NqIdMXtE1vaAdzEdBX+kbf6cfCr9pSbbW2VobOz1WYR3Tpqj35CxBeBbU=</latexit>

III. The SRW Geometry
SRW is a distance between probability measures
SRW is equivalent to the 2-Wasserstein distance
r k d W(µ, ⌫)  Sk(µ, ⌫)  W(µ, ⌫)
<latexit sha1_base64="o1uIu9M1yeBcuPmnQou8CdcpC3o=">AAAFoXicjVRNb9NAEJ0WAiV8pcCNy4ooUpFKmlRIcKyEhEDiEErTVIqryHY2rRV/JPYaKYos8e/4DfwDOHCFK2/GTpsmTYotJ+PZee/NzI7XGfleYhqNHxubt26X7tzdule+/+Dho8eV7SfHSZTGrm67kR/FJ46daN8Lddt4xtcno1jbgePrjjN8x+udrzpOvCg8MpORPg3ss9AbeK5t4OpVbGUl49hMrUFsu9NhNu1nmbIC25y7tj/tZDtWkO4qK0xfKsvX48ulL1lvuHJxHterVBv1hlxq2WgWRpWKqxVtbz4ji/oUkUspBaQpJAPbJ5sS3F1qUoNG8J3SFL4YlifrmjIqA5siSiPChneI3zO8dQtviHfmTATtQsXHEwOpqAZMhLgYNqspWU+Fmb2ruKfCyblN8O8UXAG8hs7hvQk3i/xfHNdiaEBvpQYPNY3Ew9W5BUsqXeHM1VxVBgwj+NjuYz2G7Qpy1mclmERq597asv5TItnL724Rm9KvtVkeYac4wwH0wyv55XcNT45UqOUVOudJBoxTF6h1/eOq/DnGxZsVErAGQOa9aNMhfZJOTKQTzGqkVyE4Vys5yCbCO3fQQcSiZk36HCNmIKysGsm0+ahsDFa2PNFVBUve6Zum47IP12k6MqmM4gx5x/rwzmZIXcwkz/k6rVC+IQ21fM+v0+KvISiQZok73zGerCbt0T7twtLy5dbX6Aaiy32b7Ui2pLsYEwHLWZZxtjQXT5Jl43i/3mzUm59fVw/ef8tPmS16Ti9oB5m+oQP6QC3MhUvf6Tf9ob+lauljqVU6zEM3N4qT6SlduUrdf1axICk=</latexit>

Geodesics in SRW space

⇡⇤
<latexit sha1_base64="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9p6=aKS<r3t/e+/lohoaU7eta4/ei0NxzfHiUj8txT0>97+FPrjZ1uXVnKqKps1CQFhvxs8fLCq90kck+lQk0B+lun8wb5=uc=ar<7c/b5l8fahItjseQ0xMDiABt<A>/=l=a<t/elxaite>xit>

2 ⇧(µ, ⌫)

minimizing

Xk ⇡ 7!
l=1
<latexit sha1_base64="e+ecFDuF+SEm9Zad+MErql4BINM=">AAAFaXicjVTdahNREJ7WRmv8S9QL0ZuDIdCCjdki6I1QEMQLL6o0aaGpYXdzUpec/XH3rBBCwDfwabzV5/ANFF/Cb2Y3tU3a1F02mZ0z3/fNzJk9XmKCzLbbP1dWr6xVrl5bv169cfPW7Tu1+t1uFueprzt+bOL0wHMzbYJId2xgjT5IUu2GntH73ugVr+9/1mkWxNGeHSf6KHSPo2AY+K6Fq1/b7CWB6oVuktlY9bI87E/MS2f6YaR6BiwDt282un0EbfZrjXarLZdaNJzSaFB57cb11fvUowHF5FNOIWmKyMI25FKG+5AcalMC3xFN4EthBbKuaUpVYHNEaUS48I7we4y3w9Ib4Z05M0H7UDF4UiAVNYGJEZfCZjUl67kws/ci7olwcm5j/HslVwivpY/wXoabRf4vjmuxNKQXUkOAmhLxcHV+yZJLVzhzdaoqC4YEPrYHWE9h+4Kc9VkJJpPaubeurP+SSPbyu1/G5vR7aZZ72CnOcAj96Ex+xd3EUyAVatlC5wLJgHHqBLWsf1yVOcU4f7NCBtYQyKIXHXpPb6UTY+kEs1rpVQTOi5U8ZBPjnTvoIWJesyl9ThEzFFZWjWXaDCr7BFa2AtFVJUvR6cum418fztP0ZFIZxRnyjg3gnc2QOplJnvNlWpF8QxpqxZ6fp8VfQ1gi7QJ3sWM8WQ49pW16AkvLl9taohuKLvdttiPTBd35mBhYzrKKs8WZP0kWje52y2m3nHfPGjuvvxSnzDo9ose0gUyf0w69oV3MhU9f6Rt9px9rfyr1yoPKwyJ0daU8me7RmavS+AtPMgp3</latexit>

l (V⇡ )

t
<latexit sha1_base64="gghqlEppw+3rYDMpSZR9+QjfRho=">AAAFanicjVTbbtNAEJ2GBkq4pYUX1JcVoVIpNNgVEggJqRIS4oGHgpq2Ul0i29kUq75hrxFRFIlP4Gt4hd/gD0DiIzgzdkqbtCm2Eo9n55wzMzteLw2D3FjWz7napfn65SsLVxvXrt+4eau5uLSTJ0Xm646fhEm257m5DoNYd0xgQr2XZtqNvFDvekcveX33k87yIIm3zSDVB5F7GAf9wHcNXN3mmlFO5Ka5SfAsukY9f6Gc4aq9bh58Vg+VGTijrtNy0uD9WrfZstqWXGrasCujRdW1lSzW7pBDPUrIp4Ii0hSTgR2SSznufbLJohS+AxrCl8EKZF3TiBrAFojSiHDhPcL/Id72K2+Md+bMBe1DJcQvA1LRCjAJ4jLYrKZkvRBm9p7HPRROzm2Ap1dxRfAa+gDvRbhx5P/iuBZDfXomNQSoKRUPV+dXLIV0hTNXJ6oyYEjhY7uH9Qy2L8hxn5Vgcqmde+vK+i+JZC+/+1VsQb9nZrmNneIM+9CPT+VX3iv4lUiFWtbRuUAyYJw6Rs3qH1cVnmCcvFkhB2sEZNmLDr2jN9KJgXSCWY30Kgbn+Uoesknwzh30EDGpuSJ9zhDTF1ZWTWTaQlT2EaxsBaKrKpay0xdNx78+nKXpyaQyijPkHevBO54hdTyTPOeztGL5hjTUyj0/S4u/hqhCminucsd4smx6TBv0CJaWL7c9QzcSXe7beEdGU7qTMQmwnGUDZ4s9eZJMGzsbbdtq22+ftDZffSlPmQVapnu0ikyf0ia9pi3MhU9f6Rt9px/zf+pL9bv15TK0NledTLfp1FW//xcoVAk4</latexit>

7!

µt

:= {(1

t)x + ty}#⇡⇤

SRW (left) and W (right) geodesics in presence of noise (d=30)

Dependence on dimension

k
<latexit sha1_base64="oFqu/4zyL7KqNABPe6YxXU/gIxE=">AAAFYnicjVRNb9NAEJ2GBkr4Sig3OFiNIhWppHaEBMdKSIgDhwJNW6kpke1sWiu219hrpCiKxJFfwxX+CncO8C94M3ZKm7QpthKPZ+e9NzM7Xi8Jg8zY9s+Vyo3V6s1ba7drd+7eu/+g3ni4n+k89VXX16FODz03U2EQq64JTKgOk1S5kReqA2/0itcPPqs0C3S8Z8aJOo7ckzgYBr5r4OrXN0ZWL3KTzGh+mlPfDScfph87/dFmL8q3enH+tF9v2m1bLmvRcEqjSeW1qxuVR9SjAWnyKaeIFMVkYIfkUob7iByyKYHvmCbwpbACWVc0pRqwOaIUIlx4R/g/wdtR6Y3xzpyZoH2ohPilQFrUAkYjLoXNapas58LM3qu4J8LJuY3x9EquCF5Dp/Beh5tF/i+OazE0pJdSQ4CaEvFwdX7JkktXOHPrXFUGDAl8bA+wnsL2BTnrsyWYTGrn3rqy/lsi2cvvfhmb05+lWe5hpzjDIfTjC/kVdwu/AmmhlmfoXCAZMM46Qy3rH1cVnmOcv1khA2sEZNGLLr2nt9KJsXSCWY30Kgbn1UoestF45w56iJjXbEmfU8QMhZVVtUxbiMo+gZWtQHStkqXo9HXT8a8Pl2l6MqmM4gx5xwbwzmbIOptJnvNlWrF8QwpqxZ5fpsVfQ1QizQJ3sWM8WQ5tU4e2YCn5cttLdCPR5b7NdmS6oDsfo4HlLGs4W5z5k2TR2O+0HbvtvHve3Hn9pThl1ugxbdAmMn1BO/SGdjEXPn2lb/Sdfqz+qtaqjep6EVpZKU+mdbpwVZ/8BaAEB64=</latexit>

7! Sk2(µ, ⌫)

increasing and concave

• Measures in dimension d=30, with transport only occurring in dimension 2, 4, 7 and 10 respectively.
• Use a ‘elbow’ rule of thumb to choose k in practice.

IV. Computing SRW

Entropic Regularization

• •

Ensures

uniqueness

of

optimal

⇡⇤ <latexit sha1_base64="BZEEAjSqjJ4nitmiAJWpqoPOToY=">AAAFQ3icjVRNb9NAEJ0GAyV8tcCNy4ooEkIQ7KpSOVZCQhw4FNS0ldqCbGfTrmp7jb1GiqpK/AOu8IP4EfwDEDfEFYk3Y6e0SZtiy8l4dt57M7PjjfLElM73v821LnmXr1ydv9a+fuPmrdsLi3c2SlsVse7HNrHFVhSWOjGZ7jvjEr2VFzpMo0RvRgfPeX3zgy5KY7N1N8r1bhruZWZo4tDB1d/JzdtH7xY6fs+XS00bQWN0qLnW7GLrHu3QgCzFVFFKmjJysBMKqcS9TQH5lMO3S4fwFbCMrGs6ojawFaI0IkJ4D/C7h7ftxpvhnTlLQcdQSfAUQCrqAmMRV8BmNSXrlTCz9zzuQ+Hk3Eb4jxquFF5H+/BehBtH/i+Oa3E0pGdSg0FNuXi4urhhqaQrnLk6UZUDQw4f2wOsF7BjQY77rARTSu3c21DWv0ske/k9bmIr+jEzy3XsFGc4hH52Kr/67uKpkQq1PEHnjGTAOHWMmtU/rio5wTh5s0IJ1hTIuhd9ekOvpBMj6QSzOulVBs7zlSJkY/HOHYwQManZlT4XiBkKK6tambYElb0HK1tGdFXDUnf6oun414ezNCOZVEZxhrxjA3jHM6SOZ5LnfJZWJt+Qhlq952dp8deQNkg3xV3vGE9WQE9piR7D0vLl9mbopqLLfRvvyNGU7mSMBZazbONsCSZPkmljY6kX+L3g9XJn9cXH+pSZp/v0gB4i0xVapZe0hrmIofKJPtMX76v30/vl/a5DW3PNyXSXTl3en7/Rqv+V</latexit>

Sinkhorn algorithm

Frank-Wolfe

Projected Gradient Method
Computation Time
• Warm start in Sinkhorn • Quadratic in dimension d

V. Experiments
SRW is Robust to Noise
Low-dimensional Gaussians are added noise. We plot the relative error for SRW and W distances.
Convergence of Subspaces
When the OT plan lies on a subspace, it is retrieved by SRW.

Application in NLP

Scenarios of movies are transformed into measures

in

R300 <latexit sha1_base64="ErjdaIkzVzy0CLARSRDNCy2v2RM=">AAAFUHicjVRNb9NAEJ2GhJbwlQI3LhZRJA4Q7IIEx0qVEAcOpWraSm2pbGfTrmp7XXtdKYoi8UN6hR/EjX8A/4AbvBk7pU3aFFuJZ2fnvTczO3aQRjq3rvtjoXar3ri9uHSneffe/QcPW8uPtnJTZKHqhSYy2U7g5yrSiepZbSO1k2bKj4NIbQfHa7y/faqyXJtk0w5TtR/7h4ke6NC3cB20Wnuxb4+CYLQx/jx67brjg1bb7bpyObOGVxltqq51s1x7QnvUJ0MhFRSTooQs7Ih8ynHvkkcupfDt0wi+DJaWfUVjagJbIEohwof3GP+HWO1W3gRr5swFHUIlwi8D0qEOMAZxGWxWc2S/EGb2Xsc9Ek7ObYhnUHHF8Fo6gvcm3CTyf3Fci6UBvZMaNGpKxcPVhRVLIV3hzJ0LVVkwpPCx3cd+BjsU5KTPjmByqZ1768v+T4lkL6/DKragX3Oz3MRJcYYD6CeX8ivvDn4l0kEtL9E5LRkwzjlHzesfVxVdYJy+WSEHawxk2YsebdBH6cRQOsGsVnqVgPN6pQDZGKy5gwEipjU70ucMMQNhZVUj0xahshOwsqVF16lYyk7fNB3/+nCVZiCTyijOkE+sD+9khpzzmeQ5n6eVyDukoFae+VVa/DbEFdLOcJcnxpPl0StaoRewlLy53Tm6sehy3yYnMp7RnY4xwHKWTXxbvOkvyayxtdL13K736U179f2X8iuzRE/pGT1Hpm9plT7QOuYipFM6o6/0rf69/rv+p7FQhtaqJz2mS1ej+RcaFgKF</latexit>

using Word2vec

Metric MDS of SRW distances between movies

Optimal 2D-subspace between Kill Bill (red) and Interstellar (blue)

