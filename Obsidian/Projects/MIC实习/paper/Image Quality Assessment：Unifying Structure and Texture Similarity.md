# 概述
## 背景
* FR问题
* 传统IQA算法基于像素对齐的假设，对于人眼不敏感的细微纹理变化反应很强，忽略了纹理的相似性
* 目前已经存在一些基于CNN的方法，可以很好地表示出图像的纹理信息，可以应用在纹理相似性的比较上
## 问题
* 传统IQA算法，由于需要将待比较的图片与Reference 图片逐像素对齐，因此对于细微的几何变化、纹理变化或者重采样会产生非常强的反应，极大降低评价分数。但实际上在HVS系统中这样的变化可能并不明显。
* 有相关研究将图像质量的损失分解成局部图像结构、分布式结构和非结构信息的线性组合，但HVS对各种损失的关注程度实际上并不明确，没有确定的方法可以确认对各种信息的关注程度。
	* 并且也不是简单的这几种结构的线性组合
## 贡献
* 提出了关注结构信息以及对细小纹理变化敏感度较低、更加接近HVS的DISTS index算法，结合了纹理特征与全局的结构测量结果
* 在特征提取VGG网络中，使用$l_2 pooling$代替$max pooling$，避免了混叠，同时也增加了模型对于低程度结构变化的容忍
* 将原图作为第0层特征图像，共同参与结构和纹理信息的提取，保证了DISTS方法的单射性，可以使用此算法进行损失图像的修复
* 受ssim思想的启发，设计了从深度feature map中提取并比较可以用来表达纹理信息的方法，用于比较图片之间的纹理相似度
## 疑问
* 为什么2569的图像复原实验可以用于说明DISTS的单射性
* 为什么SSIM可以产生spatial map，而DISTS不行
* overcomplete representation：![[Pasted image 20221104121347.png]]
# 具体工作
* frame work
	* stage/scale：卷积、激活（active）、归一化（pooling）
	* 第一层：通道增加，而尺度不变
	* down sample：通道数\*2，长宽各缩短1/2，维度变为原来的一半
	* overcomplete representation：在下采样后上采样，让feature map长宽与原图片相同
![[Pasted image 20221104121617.png]]
* 具体模块
	* 使用改进过的VGG网络，使用overcomplete representation，提出reference image和distorted image 的逐层深度信息
	* 收到SSIM的启发，设计了基于统计信息的结构相似性和纹理相似性的测量方法![[Pasted image 20221104122111.png]]
	* 线性结合各层的结构相似性与纹理相似性![[Pasted image 20221104122407.png]]
	  对于结合的参数，使用MOS与IQA预测结果的差距作为loss![[Pasted image 20221104122325.png]]
	  使用网络训练，求得最合适的alpha和beta
# 实验
## 定性结果
* 分别使用多种基于CNN的IQA算法进行了图像复原测试，使用梯度下降器求解下面的方程，发现DISTS 的还原效果最佳，保留了比较完整的结构和纹理信息$$
 y^*=argmin_y(x,y)
 $$![[Pasted image 20221104123536.png]]
* 对纹理采用多种方法（包括jpeg、jpeg2000、pink noise等）对纹理进行扰动，通过四种texture synthesis方法对纹理进行了综合，将结果与原图混合，使用DISTS算法对texture similarity进行评分，下图为评分降序的结果![[Pasted image 20221104124549.png]]
* 通过对原图添加细微的几何变换（包括平移、旋转等），测试DISTS对几何变化的包容程度，与SSIM比较，本算法认为上面一组图片评分更高，而SSIM（由于基于像素对其的假设）认为下面一组图片评分更高，显然DISTS更符合HVS的结果![[Pasted image 20221104125847.png]]
## 定量结果
- 首先在经典数据集上表现一般，但线性性更好，作者认为可能是其他模型过拟合的结果
![[Pasted image 20221104172822.png]]
 - 通过此图，作者发现本算法的线性度较好，拟合出的结果接近直线
 ![[Pasted image 20221104172846.png]]
 - 通过此表，测试三个经典数据集的效果，通过皮尔逊线性相关系数斯皮尔曼等级相关系数以及肯德尔相关系数证明准确性,在经典数据集上，本方法在上述三种评价指标下都表现一般。
- 但面对BAPPS测试集，未在此上训练过的本算法与在此之上训练的LPIPS效果相近，证明泛化性
![[Pasted image 20221104172916.png]]
 - 对于此表，采用了综合的扰动以及现实世界的扰动，未在此训练过的DISTS算法，通过2AFC(人类算法共选择)的方式来衡量，得到了较好的结果，证明选择的一致性以及算法的泛化性
* 构建了一个综合纹理数据集TQD，基于10张纹理图片，对其进行各种常规扰动，之后使用纹理综合算法对扰动过后的纹理进行综合，得到distorted image，使用原本的纹理进行综合，得到high quailty的reference 图片，在自己构造的TQG以及已经存在的综合纹理数据集synTEX对多种IQA算法（包括一种比较纹理相似度的算法IGSTQA）进行测试，使用PLCC、SRCC等指标进行比较，可以发现DISTS明显好于其他算法（甚至优于纹理相似度比较算法IGSTQA）                                                                          ![[Pasted image 20221104132417.png]]
* 测试了DISTS算法在texture classification问题上的性能。对于每一个纹理会被分成九块，额外实现了一个简单的k-NN分类算法作为baseline，九块纹理中的五块用于train，两块用于validation，两块用于test                                                   ![[Pasted image 20221104132810.png]]
  下图为各种算法的分类精准度，可以发现以上简单的k-NN算法优于大部分基于图像相似性的分类器，说明DISTS在区分和分类对人眼而言非常相似的纹理方面具有不错的效果![[Pasted image 20221104133331.png]]
  * 测试了DISTS对轻微几何变化的容忍程度，对原本的图像采取了轻微的旋转、平移、变焦等改变，测试DISTS对于改变后的图片的评价分数，由于HVS对于这一类轻微的几何变化并不敏感，原则上而言改变过后的图片应该具有比较高的分数。将本算法与一系列其他IQA算法进行了对比，发现在容忍轻微几何改变的方法，基于CNN的算法明显优于传统算法。![[Pasted image 20221104134214.png]]
  ## 消融实验
  消融实验
- LPIPS+l2 pooling：好一点，l2消除aliasing有效果
- 加入输入图片：好一点，但是对感知优化很重要
- 全局的SSIM类型的距离的表现超过欧氏距离，尤其是在可视的纹理以及图形变换上，局部的SSIM效果较次
- 纹理重采样距离加入loss中，稍微降低了传统算法表现，但是对于纹理不敏感化还是很重要的![[Pasted image 20221104134758.png]]
# 启示
- 本文中使用了一种采用梯度下降方式和IQA算法对distoted图片进行修复的方法，用于衡量DISTS的性能表现。这种方法本身也可以作为一种修复算法应用在图像处理领域中，前提是要求提供的IQA算法具有单射的性质。之后可以采用本方法进行单射性质的检测和损坏图像的修复。
- 使用CNN提取图像纹理特征并进行统计学的计算，虽然相较于传统方法计算视觉层面上的纹理信息而言，具有更高的准确度和对深层纹理、结构信息的敏感度。但也导致了模型的函数过于复杂，特别是使用了CNN之后一定会出现非凸的特性，这一点对于基于IQA和梯度下降的图像修复算法而言，需要消耗更大的计算量和进行更多次数的迭代，同时也导致模型本身的优化变得更加困难。**考虑如何在减少非凸特性不良影响的同时采集到更多的深层结构信息** 